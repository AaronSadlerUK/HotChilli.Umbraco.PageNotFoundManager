{"version":3,"file":"pagenotfound.modal.element-Cxb9nyHz.js","sources":["../../hc.pagenotfoundmanager.client/src/Modals/pagenotfound.modal.element.ts"],"sourcesContent":["import { customElement, html, state } from \"@umbraco-cms/backoffice/external/lit\";\r\nimport { UmbModalBaseElement, UmbModalRejectReason } from \"@umbraco-cms/backoffice/modal\";\r\nimport type { UmbInputDocumentElement } from \"@umbraco-cms/backoffice/document\";\r\nimport { UmbDocumentItemRepository } from \"@umbraco-cms/backoffice/document\";\r\n\r\nimport { PageNotFoundModalData, PageNotFoundModalValue } from \"./pagenotfound.modal.token.ts\";\r\nimport { PageNotFoundManagerService } from \"../api/services.gen.ts\";\r\n\r\n@customElement('page-not-found-modal')\r\nexport class PageNotFoundModalElement extends UmbModalBaseElement<PageNotFoundModalData, PageNotFoundModalValue>\r\n{\r\n    @state()\r\n\tprivate _selection?: string;\r\n\r\n    @state()\r\n\tprivate _documentName = '';\r\n\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    connectedCallback() {\r\n        super.connectedCallback();\r\n\r\n        if(this.data?.entityKey){\r\n            // Use Swagger API client to get the record\r\n            // this._getExamineRecord(this.data.entityKey).then((record) => {\r\n            //     this.examineRecord = record;\r\n            // });\r\n            console.log(`PNFM: ${this.data?.entityKey}`);\r\n        }\r\n        else {\r\n            // This is a problem\r\n            console.error(\"PNFM: connectedCallback. There is NO EntityKey passed into the modal\");\r\n        }\r\n\r\n        this.#getDocumentName();\r\n    }\r\n\r\n    private handleClose() {\r\n        this.modalContext?.reject({ type: \"close\" } as UmbModalRejectReason);\r\n    }\r\n\r\n    private async handleSave() {\r\n        console.log(\"PNFM save triggered\");\r\n        var res = await PageNotFoundManagerService.postApiV1HcsSetNotFound(\r\n            {\r\n                requestBody: {\r\n                    parentId: this.data?.entityKey ?? \"\",\r\n                    notFoundPageId: this._selection\r\n                }\r\n            }\r\n        );\r\n        console.log(res);\r\n        this.modalContext?.submit();\r\n    }\r\n\r\n    #selectionChanged(e: CustomEvent) {\r\n\t\tthis._selection = (e.target as UmbInputDocumentElement).selection[0];\r\n\t}\r\n\r\n    async #getDocumentName() {\r\n\t\tif (!this.data?.entityKey) return;\r\n\t\t// Should this be done here or in the action file?\r\n\t\tconst { data } = await new UmbDocumentItemRepository(this).requestItems([this.data.entityKey]);\r\n\t\tif (!data) return;\r\n\t\tconst item = data[0];\r\n\t\t//TODO How do we ensure we get the correct variant?\r\n\t\tthis._documentName = item.variants[0]?.name;\r\n\r\n\t}\r\n\r\n    render() {\r\n        console.log(this.data);\r\n        return html`\r\n            <umb-body-layout headline=\"Page Not Found #BETA#\">\r\n                <uui-box headline=\"Data\">\r\n                    Current node: \"${this._documentName}\"\r\n\r\n                    <umb-input-document min=1 max=1\r\n                        .value=${this._selection}\r\n                        @change=${this.#selectionChanged}>\r\n                    </umb-input-document>\r\n                </uui-box>\r\n                                \r\n                <div slot=\"actions\">\r\n                    <uui-button id=\"close\" label=\"Close\" @click=\"${this.handleSave}\">Save & Close</uui-button>\r\n                    <uui-button id=\"close\" label=\"Close\" @click=\"${this.handleClose}\">Close</uui-button>\r\n                </div>\r\n            </umb-body-layout>\r\n        `;\r\n    }\r\n}\r\n\r\nexport default PageNotFoundModalElement;"],"names":["_PageNotFoundModalElement_instances","selectionChanged_fn","getDocumentName_fn","PageNotFoundModalElement","UmbModalBaseElement","__privateAdd","_a","_b","__privateMethod","res","PageNotFoundManagerService","html","data","UmbDocumentItemRepository","item","__decorateClass","state","customElement","PageNotFoundModalElement$1"],"mappings":";;;;;;;;;;8OAAAA,GAAAC,GAAAC;AASa,IAAAC,IAAN,cAAuCC,EAC9C;AAAA,EAOI,cAAc;AACJ,aATPC,EAAA,MAAAL,CAAA,GAMN,KAAQ,gBAAgB;AAAA,EAIrB;AAAA,EAEA,oBAAoB;;AAChB,UAAM,kBAAkB,IAErBM,IAAA,KAAK,SAAL,QAAAA,EAAW,YAKV,QAAQ,IAAI,UAASC,IAAA,KAAK,SAAL,gBAAAA,EAAW,SAAS,EAAE,IAI3C,QAAQ,MAAM,sEAAsE,GAGxFC,EAAA,MAAKR,GAALE,CAAA,EAAA,KAAA,IAAA;AAAA,EACJ;AAAA,EAEQ,cAAc;;AAClB,KAAAI,IAAA,KAAK,iBAAL,QAAAA,EAAmB,OAAO,EAAE,MAAM,QAAiC;AAAA,EACvE;AAAA,EAEA,MAAc,aAAa;;AACvB,YAAQ,IAAI,qBAAqB;AAC7B,QAAAG,IAAM,MAAMC,EAA2B;AAAA,MACvC;AAAA,QACI,aAAa;AAAA,UACT,YAAUJ,IAAA,KAAK,SAAL,gBAAAA,EAAW,cAAa;AAAA,UAClC,gBAAgB,KAAK;AAAA,QACzB;AAAA,MACJ;AAAA,IAAA;AAEJ,YAAQ,IAAIG,CAAG,IACfF,IAAA,KAAK,iBAAL,QAAAA,EAAmB;AAAA,EACvB;AAAA,EAiBA,SAAS;AACG,mBAAA,IAAI,KAAK,IAAI,GACdI;AAAA;AAAA;AAAA,qCAGsB,KAAK,aAAa;AAAA;AAAA;AAAA,iCAGtB,KAAK,UAAU;AAAA,kCACdH,QAAKR,GAAiBC,CAAA,CAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mEAKW,KAAK,UAAU;AAAA,mEACf,KAAK,WAAW;AAAA;AAAA;AAAA;AAAA,EAI/E;AACJ;AAnFOD,IAAA,oBAAA,QAAA;AAgDHC,IAAiB,SAAC,GAAgB;AACpC,OAAK,aAAc,EAAE,OAAmC,UAAU,CAAC;AACpE;AAESC,IAAgB,iBAAG;;AACvB,MAAA,GAACI,IAAA,KAAK,SAAL,QAAAA,EAAW,WAAW;AAE3B,QAAM,EAAE,MAAAM,EAAA,IAAS,MAAM,IAAIC,EAA0B,IAAI,EAAE,aAAa,CAAC,KAAK,KAAK,SAAS,CAAC;AAC7F,MAAI,CAACD,EAAM;AACL,QAAAE,IAAOF,EAAK,CAAC;AAEnB,OAAK,iBAAgBL,IAAAO,EAAK,SAAS,CAAC,MAAf,gBAAAP,EAAkB;AAExC;AA1DQQ,EAAA;AAAA,EADJC,EAAM;AAAA,GAFEb,EAGJ,WAAA,cAAA,CAAA;AAGAY,EAAA;AAAA,EADJC,EAAM;AAAA,GALEb,EAMJ,WAAA,iBAAA,CAAA;AANIA,IAANY,EAAA;AAAA,EADNE,EAAc,sBAAsB;AAAA,GACxBd,CAAA;AAqFb,MAAAe,IAAef;"}